<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DetektPomModel.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">code-coverage-report</a> &gt; <a href="index.source.html" class="el_package">io.github.detekt.parser</a> &gt; <span class="el_source">DetektPomModel.kt</span></div><h1>DetektPomModel.kt</h1><pre class="source lang-java linenums">package io.github.detekt.parser

import org.jetbrains.kotlin.com.intellij.openapi.util.UserDataHolderBase
import org.jetbrains.kotlin.com.intellij.pom.PomModel
import org.jetbrains.kotlin.com.intellij.pom.PomModelAspect
import org.jetbrains.kotlin.com.intellij.pom.PomTransaction
import org.jetbrains.kotlin.com.intellij.pom.impl.PomTransactionBase
import org.jetbrains.kotlin.com.intellij.pom.tree.TreeAspect
import sun.reflect.ReflectionFactory

/**
 * Adapted from https://github.com/pinterest/ktlint/blob/0.50.0/ktlint-rule-engine/src/main/kotlin/com/pinterest/ktlint/rule/engine/internal/KotlinPsiFileFactory.kt
 * Licenced under the MIT licence - https://github.com/pinterest/ktlint/blob/master/LICENSE
 */
object DetektPomModel : UserDataHolderBase(), PomModel {

    override fun runTransaction(transaction: PomTransaction) {
<span class="pc bpc" id="L18" title="1 of 2 branches missed.">        val transactionCandidate = transaction as? PomTransactionBase</span>

<span class="pc bpc" id="L20" title="1 of 2 branches missed.">        val pomTransaction = requireNotNull(transactionCandidate) {</span>
<span class="nc" id="L21">            &quot;${PomTransactionBase::class.simpleName} type expected, actual is ${transaction.javaClass.simpleName}&quot;</span>
        }

<span class="fc" id="L24">        pomTransaction.run()</span>
<span class="fc" id="L25">    }</span>

    override fun &lt;T : PomModelAspect?&gt; getModelAspect(aspect: Class&lt;T&gt;): T? {
<span class="pc bpc" id="L28" title="1 of 2 branches missed.">        if (aspect == TreeAspect::class.java) {</span>
<span class="fc" id="L29">            val constructor = ReflectionFactory.getReflectionFactory()</span>
<span class="fc" id="L30">                .newConstructorForSerialization(aspect, Any::class.java.getDeclaredConstructor())</span>
            @Suppress(&quot;UNCHECKED_CAST&quot;)
<span class="fc" id="L32">            return constructor.newInstance() as T</span>
        }
<span class="nc" id="L34">        return null</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202408290909</span></div></body></html>